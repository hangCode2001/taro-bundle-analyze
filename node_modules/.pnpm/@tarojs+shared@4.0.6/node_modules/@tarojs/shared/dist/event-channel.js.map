{"version":3,"file":"event-channel.js","sources":["../src/event-channel.ts"],"sourcesContent":["import { Events } from './event-emitter'\n\ninterface ExeListItem {\n  eventName: string\n  data: Record<string, any>\n}\n\ninterface RouteEvt extends Events {\n  addEvents: (events: any) => void\n  emit?: (events: any, data: any) => void\n}\n\ninterface PageEvt extends Events {\n  exeList: any[]\n  emit?: (events: any, data: any) => void\n}\n\nclass PageEvts extends Events {\n  exeList = []\n\n  on (eventName, callback) {\n    super.on(eventName, callback, this)\n    this.exeList = this.exeList.reduce((prev: any, item: ExeListItem) => {\n      if (item.eventName === eventName) {\n        super.trigger(item.eventName, item.data)\n      } else {\n        prev.push(item)\n      }\n      return prev\n    }, [])\n    return this\n  }\n\n  emit (events, data) {\n    // eslint-disable-next-line\n    routeChannel.trigger(events, data)\n  }\n}\n\nconst pageChannel: PageEvt = new PageEvts()\n\nclass RouteEvts extends Events {\n  emit (events, data) {\n    pageChannel.off(events)\n    pageChannel.exeList.push({\n      eventName: events,\n      data\n    })\n  }\n\n  addEvents (events) {\n    if (!events || typeof events !== 'object') return\n    Object.keys(events).forEach(key => {\n      this.off(key)\n      this.on(key, events[key], this)\n    })\n  }\n}\n\nconst routeChannel: RouteEvt = new RouteEvts()\n\nexport const EventChannel = { pageChannel, routeChannel }\n"],"names":[],"mappings":";;AAiBA,MAAM,QAAS,SAAQ,MAAM,CAAA;AAA7B,IAAA,WAAA,GAAA;;QACE,IAAO,CAAA,OAAA,GAAG,EAAE,CAAA;KAmBb;IAjBC,EAAE,CAAE,SAAS,EAAE,QAAQ,EAAA;QACrB,KAAK,CAAC,EAAE,CAAC,SAAS,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAA;AACnC,QAAA,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAS,EAAE,IAAiB,KAAI;AAClE,YAAA,IAAI,IAAI,CAAC,SAAS,KAAK,SAAS,EAAE;gBAChC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;aACzC;iBAAM;AACL,gBAAA,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;aAChB;AACD,YAAA,OAAO,IAAI,CAAA;SACZ,EAAE,EAAE,CAAC,CAAA;AACN,QAAA,OAAO,IAAI,CAAA;KACZ;IAED,IAAI,CAAE,MAAM,EAAE,IAAI,EAAA;;AAEhB,QAAA,YAAY,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,CAAA;KACnC;AACF,CAAA;AAED,MAAM,WAAW,GAAY,IAAI,QAAQ,EAAE,CAAA;AAE3C,MAAM,SAAU,SAAQ,MAAM,CAAA;IAC5B,IAAI,CAAE,MAAM,EAAE,IAAI,EAAA;AAChB,QAAA,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;AACvB,QAAA,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC;AACvB,YAAA,SAAS,EAAE,MAAM;YACjB,IAAI;AACL,SAAA,CAAC,CAAA;KACH;AAED,IAAA,SAAS,CAAE,MAAM,EAAA;AACf,QAAA,IAAI,CAAC,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ;YAAE,OAAM;QACjD,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,GAAG,IAAG;AAChC,YAAA,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;AACb,YAAA,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAA;AACjC,SAAC,CAAC,CAAA;KACH;AACF,CAAA;AAED,MAAM,YAAY,GAAa,IAAI,SAAS,EAAE,CAAA;MAEjC,YAAY,GAAG,EAAE,WAAW,EAAE,YAAY;;;;"}